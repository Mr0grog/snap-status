<% content_for :title do %><%= state %><% end %>

<% content_for :body do %>
  <h1><%= state %></h1>
  
  <% monitors.each do |monitor| %>
    <section id="state-<%= monitor[:meta]["state_abbreviation"] %>" class="status-<%= monitor[:status] %>">
      <h2>
        <%= monitor[:name] %> - 
        <span class="status">
          <% if monitor[:status] == :unknown %>
            not monitored
          <% elsif monitor[:status] == :down %>
            down!
          <% else %>
            operating normally
          <% end %>
        </span>
      </h2>
      <p><a href="<%= monitor[:url] %>"><%= monitor[:url] %></a></p>
      
      Most recent snapshots:
      <ol class="snapshots">
      <% monitor[:snapshots].slice(0, 10).each do |snapshot, index| %>
        <li>
          <a href="<%= snapshot.url %>">
            <img src="<%= snapshot.render_url({w: 200}) %>" alt="" />
            <%= snapshot.date.getlocal.strftime("%Y-%m-%d %I:%M %P") %>
          </a>
        </li>
      <% end %>
      </ol>
      <% if monitor[:snapshots].count > 10 %>
        â€¦and <%= monitor[:snapshots].count - 10 %> more.
      <% end %>
    </section>
  <% end %>
<% end %>

<%= erb :'layouts/app' %>
